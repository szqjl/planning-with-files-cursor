# Planning with Files - Cursor Rules

> 将 Manus AI 的规划工作流模式集成到 Cursor IDE

## 🎯 核心工作流：3-File Pattern

对于每个复杂任务（3+ 步骤），自动使用以下三个文件：

1. **task_plan.md** - 跟踪阶段和进度
2. **notes.md** - 存储研究和发现
3. **[deliverable].md** - 最终交付物

## 🔄 自动触发条件

当用户请求以下类型的任务时，自动激活规划工作流：

- 多步骤任务（3+ 步骤）
- 研究任务
- 构建/创建项目
- 提到"规划"、"组织"、"跟踪进度"、"工作流"
- 请求结构化工作
- 进行多步骤研究

## 📋 工作流执行规则

### 1. 任务开始时

如果任务符合复杂任务条件，必须：

1. **创建 task_plan.md**
   - 定义清晰的项目目标
   - 划分项目阶段（Phase 1, Phase 2, ...）
   - 使用复选框跟踪进度 `- [ ]`
   - 标记当前阶段为 `(CURRENT)`

2. **创建 notes.md**
   - 用于存储研究、发现、想法
   - 记录问题和解决方案

3. **读取现有计划**（如果存在）
   - 在做出重要决策前，必须先读取 `task_plan.md`
   - 确保目标保持在注意力窗口中

### 2. 执行过程中

- **自动判断当前阶段** → 读取 `task_plan.md`，找到标记为 `(CURRENT)` 的阶段
- **自动执行当前阶段** → 直接执行当前阶段的任务，**不要询问用户确认**
  - 如果 task_plan.md 中明确标记了当前阶段，立即开始执行
  - 如果"下一步行动"部分有明确指示，直接执行
  - 只有在遇到无法解决的问题或需要重大决策时才询问用户
- **研究阶段** → 保存发现到 `notes.md`
- **完成阶段** → 更新 `task_plan.md` 中的复选框 `- [x]`，自动进入下一阶段
- **遇到问题** → 记录到 `notes.md` 的"遇到的问题"部分
- **重要决策** → 重新读取 `task_plan.md` 保持目标清晰
- **重要里程碑** → 检查并更新项目文档（如 README.md）
  - 如果阶段完成影响项目整体状态，必须更新项目 README
  - 确保项目文档与任务进度同步

### 3. 任务完成时

- 更新 `task_plan.md` 标记所有阶段完成
- 创建最终交付物文件
- 在 `task_plan.md` 的"已完成"部分记录总结
- **检查并更新项目文档**（如 README.md）
  - 如果任务状态影响项目整体状态，必须同步更新项目 README
  - 确保项目文档反映最新状态
  - 验证文档一致性

### 4. 自动执行规则（重要）

**核心原则：减少不必要的用户确认，根据 task_plan.md 自动执行**

1. **读取 task_plan.md 后，自动判断当前阶段**
   - 找到标记为 `(CURRENT)` 的阶段
   - 找到"当前状态"部分
   - 找到"下一步行动"部分
   - **直接执行，不要询问用户**

2. **阶段执行规则**
   - 如果当前阶段明确，立即开始执行该阶段的任务
   - 如果"下一步行动"有明确指示，直接执行
   - 只有在以下情况才询问用户：
     - 遇到无法解决的问题
     - 需要用户做出重大决策
     - 需要用户提供额外信息

3. **阶段完成判断**
   - 完成当前阶段的所有任务后，自动更新复选框 `- [x]`
   - 自动将下一阶段标记为 `(CURRENT)`
   - 自动更新"当前状态"部分
   - **不要询问用户是否继续，直接进入下一阶段**

4. **避免的询问模式**
   - ❌ "需要我现在开始...，还是先继续...？" → ✅ 直接执行当前阶段
   - ❌ "需要我...吗？" → ✅ 如果 task_plan.md 中有指示，直接执行
   - ❌ "接下来需要...，需要我现在开始吗？" → ✅ 直接开始执行

5. **允许的询问情况**
   - ✅ 遇到技术难题，需要用户提供信息
   - ✅ 需要用户在多个方案中选择
   - ✅ 需要用户确认重要决策（如删除文件、修改核心逻辑）

## 📝 文件结构规范

### task_plan.md 结构

```markdown
# 任务计划：[任务名称]

## 🎯 项目目标
[清晰描述目标]

## 📋 项目阶段
- [x] Phase 1: [阶段名称] ✅
- [ ] Phase 2: [阶段名称] (CURRENT)
- [ ] Phase 3: [阶段名称]

## 📊 当前状态
**当前阶段**: Phase X
**下一步行动**: [具体行动]

## 🔄 工作流循环
1. 创建计划 → task_plan.md
2. 研究探索 → notes.md
3. 更新计划 → 更新进度
4. 开发实现 → 创建交付物
5. 验证测试 → 更新状态

## 🐛 已知问题
[记录遇到的问题]

## ✅ 已完成
[已完成的事项]
```

### notes.md 结构

```markdown
# 研究笔记：[任务名称]

## 📚 参考资料
[相关链接和资源]

## 🔍 研究内容
[研究过程和发现]

## 💡 发现和想法
[重要洞察]

## 🐛 遇到的问题
[问题和解决方案]

## 📝 待验证假设
[需要验证的想法]
```

## 🛡️ Manus 原则

严格遵循以下原则：

1. **文件系统作为内存**
   - 所有研究、计划、笔记都存储在文件中
   - 不要依赖上下文记忆，始终写入文件

2. **注意力操作**
   - 每次决策前重新读取 `task_plan.md`
   - 确保目标始终在注意力窗口中

3. **错误持久化**
   - 所有问题和解决方案记录到 `notes.md`
   - 避免重复相同的错误

4. **目标跟踪**
   - 使用复选框 `- [ ]` 和 `- [x]` 跟踪进度
   - 定期更新 `task_plan.md` 的状态

5. **仅追加上下文**
   - 不修改历史记录，只追加新内容
   - 保持文件历史完整性

## 🚫 不适合使用工作流的场景

以下场景**不需要**创建规划文件：

- 简单问题（单步操作）
- 单文件编辑
- 快速查找
- 一次性查询
- 简单问答

## 📖 模板文件位置

如果项目中有 `docs/planning/` 目录，可以使用其中的模板：

- `docs/planning/task_plan_template.md`
- `docs/planning/notes_template.md`

## ⚡ 快速参考

**创建规划工作流**：
```
用户："研究 TypeScript 的优势并写总结"
→ 创建 task_plan.md 和 notes.md
→ 按阶段执行
→ 更新进度
→ 创建总结文件
```

**更新进度**：
```
完成阶段后 → 更新 task_plan.md 复选框
遇到问题 → 记录到 notes.md
重要决策 → 重新读取 task_plan.md
重要里程碑 → 检查并更新项目 README（如需要）
任务完成时 → 同步项目文档状态
```

**自动执行**：
```
读取 task_plan.md → 找到 (CURRENT) 阶段 → 直接执行，不询问用户
完成阶段任务 → 更新复选框 → 自动进入下一阶段 → 继续执行
遇到问题 → 记录到 notes.md → 尝试解决 → 无法解决时才询问用户
```

---

**版本**: v1.0  
**基于**: [planning-with-files](https://github.com/OthmanAdi/planning-with-files)  
**模式**: Manus AI 规划工作流

